<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Music Player + PayPal</title>
<style>
  :root{
    --bg:#0f1724;
    --card:#0b1220;
    --accent:#00c2ff;
    --text:#e6eef8;
    --muted:#95a3b6;
  }

  body {
    margin: 0;
    padding: 40px;
    font-family: Inter, Segoe UI, Arial, sans-serif;
    background: linear-gradient(180deg, #071029 0%, #071726 60%);
    color: var(--text);
  }

  h1 { text-align:center; margin-bottom:30px; font-weight:600; }

  .track-list {
    max-width: 700px; margin: 0 auto;
  }

  .track {
    display:flex; justify-content:space-between; align-items:center;
    background:var(--card); padding:16px 18px; border-radius:12px; margin-bottom:14px;
    border:1px solid rgba(255,255,255,0.04); transition:0.25s;
  }

  .track.active { border:1px solid var(--accent); box-shadow:0 0 14px rgba(0,194,255,0.4); }

  .track-controls {
    display:flex; align-items:center; gap:12px;
  }

  button {
    background:var(--accent); border:none; border-radius:8px; padding:8px 18px;
    color:#06202b; font-weight:600; cursor:pointer; transition:0.2s;
  }
  button:hover { filter:brightness(1.15); }

  audio { width:100%; max-width:700px; display:block; margin:35px auto 0; }

  .pay-section {
    max-width:700px; margin:50px auto; padding:22px;
    background:var(--card); border-radius:14px; border:1px solid rgba(255,255,255,0.04);
    text-align:center;
  }
  .price { font-size:20px; margin-bottom:10px; font-weight:600; }
  .desc { color:var(--muted); font-size:14px; margin-bottom:20px; }
</style>
</head>
<body>

<h1>Music Player</h1>

<div class="track-list" id="trackList"></div>

<!-- important: crossorigin="anonymous" -->
<audio id="player" controls crossorigin="anonymous"></audio>

<div class="pay-section">
  <div class="price">$4.99</div>
  <div class="desc">Unlock full-quality downloads + commercial license.</div>

  <div id="paypal-button-container"></div>
</div>

<script>
/* ============================
   TRACK LIST
============================= */

const tracks = [
  "Echoes of You.mp3",
  "Memory Loops.mp3",
  "Us, Finally.mp3"
];

/* ============================
   Cloud Run public URL
   ì˜ˆ: https://music-server-xxxx.run.app/music/
============================= */

const CLOUD_RUN_BASE = "https://music-server-777936161804.europe-west1.run.app/music/";

const trackListDiv = document.getElementById("trackList");
const player = document.getElementById("player");

let currentBtn = null;
let currentTrackDiv = null;

/* ============================
   CREATE TRACK UI
============================= */

tracks.forEach(filename => {
  const encoded = encodeURIComponent(filename);

  const div = document.createElement("div");
  div.className = "track";

  const name = document.createElement("span");
  name.textContent = filename.replace(".mp3", "");

  const controls = document.createElement("div");
  controls.className = "track-controls";

  const btn = document.createElement("button");
  btn.textContent = "Play";

  btn.onclick = async () => {
    if (player.src.includes(encoded) && !player.paused) {
      player.pause();
      btn.textContent = "Play";
      div.classList.remove("active");
      return;
    }

    player.src = CLOUD_RUN_BASE + encoded;
    await player.play();

    if (currentBtn) currentBtn.textContent = "Play";
    if (currentTrackDiv) currentTrackDiv.classList.remove("active");

    btn.textContent = "Pause";
    div.classList.add("active");

    currentBtn = btn;
    currentTrackDiv = div;
  };

  controls.appendChild(btn);
  div.appendChild(name);
  div.appendChild(controls);
  trackListDiv.appendChild(div);
});

player.onended = () => {
  if (currentBtn) currentBtn.textContent = "Play";
  if (currentTrackDiv) currentTrackDiv.classList.remove("active");
};
</script>

<!-- PAYPAL BUTTON -->
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>

<script>
paypal.Buttons({
  createOrder: function(data, actions) {
    return actions.order.create({ purchase_units: [{ amount: { value: '4.99' }}] });
  },
  onApprove: function(data, actions) {
    return actions.order.capture().then(function(details) {
      alert("Payment completed by " + details.payer.name.given_name);
    });
  }
}).render('#paypal-button-container');
</script>

</body>
</html>
