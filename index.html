<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Music Player</title>

<style>
  body {
    margin: 0;
    padding: 40px;
    font-family: Arial, sans-serif;
    background: #0f1724;
    color: #fff;
  }

  h1 {
    text-align:center;
    margin-bottom:30px;
  }

  .track-list {
    max-width: 700px;
    margin: 0 auto;
  }

  .track {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #1b2a41;
    padding: 16px;
    border-radius: 10px;
    margin-bottom: 12px;
  }

  button {
    background: #00c2ff;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
  }

  audio {
    width: 100%;
    max-width: 700px;
    margin: 25px auto;
    display: block;
  }
</style>
</head>

<body>

<h1>Music Player</h1>

<div class="track-list" id="trackList"></div>

<audio id="player" controls></audio>

<script>
// ================================
// ðŸ”¥ Cloud Run URL (ë‹¹ì‹ ì˜ ì„œë²„)
// ================================
const BASE = "https://music-server-777936161804.europe-west1.run.app/music/";

// ================================
// ðŸ”¥ ìž¬ìƒí•  mp3 ëª©ë¡
// ================================
const tracks = [
  "Echoes of You.mp3",
  "Memory Loops.mp3",
  "Us, Finally.mp3"
];

const trackListDiv = document.getElementById("trackList");
const player = document.getElementById("player");

let currentBtn = null;
let currentDiv = null;

// ================================
// ðŸ”¥ Track ë¦¬ìŠ¤íŠ¸ ìƒì„±
// ================================
tracks.forEach(filename => {
  const encoded = encodeURIComponent(filename);

  const div = document.createElement("div");
  div.className = "track";

  const lbl = document.createElement("span");
  lbl.textContent = filename.replace(".mp3", "");

  const btn = document.createElement("button");
  btn.textContent = "Play";

  btn.onclick = () => {
    // ê°™ì€ íŒŒì¼ play ì¤‘ì´ë©´ pause
    if (player.src.includes(encoded) && !player.paused) {
      player.pause();
      btn.textContent = "Play";
      return;
    }

    // ìƒˆ íŒŒì¼ ìž¬ìƒ
    player.src = BASE + encoded;
    player.play();

    // ì´ì „ ë²„íŠ¼ ì´ˆê¸°í™”
    if (currentBtn) currentBtn.textContent = "Play";

    btn.textContent = "Pause";
    currentBtn = btn;
  };

  div.appendChild(lbl);
  div.appendChild(btn);
  trackListDiv.appendChild(div);
});

// ================================
// ðŸ”¥ ìž¬ìƒ ëë‚˜ë©´ ë²„íŠ¼ ìƒíƒœ ë³µêµ¬
// ================================
player.onended = () => {
  if (currentBtn) currentBtn.textContent = "Play";
};
</script>

</body>
</html>
